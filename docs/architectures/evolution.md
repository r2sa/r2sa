# 架构演化
单体架构 -> 分层架构(水平、垂直)

## 单体架构
### 优点
- simple to dev
- simple to test
- simple to deploy
- simple to scale

### 应用场景
- 业务场景简单、功能不复杂、研发人员较少
	- O2O
- 创业公司初期
- 性能要求极其苛刻 (平均响应时间)
	- 股票高频交易

### 缺点
- 系统耦合性高
- 技术选项单一
- 开发效率越来越低下

### 如何破局
- 数据库存储量大破局思路
	- 拆分
		- 垂直拆分(分库)
		- 水平拆分(分表)
- 架构同理
	- 垂直方向拆分(业务维度)
	- 水平方向拆分(功能维度) 

## 水平分层架构
### 架构设计
- 水平方向物理分成多个独立进程
	- 网关层
	- 业务逻辑层
	- 数据访问层
	- 数据存储层
- 每层逻辑解耦

#### 网关层
- 功能
	- 请求鉴权
	- 数据完整性检查
	- 协议转换
	- 路由转发
	- 服务治理
- 开源网关组件
	(
		|对比维度|Zuul(推荐)|Spring Clound Geteway|Nginx|Kong|Tyk|Node.js|
		|---|---|---|---|---|---|---|
		|编程语言|Java|Java|C|C + lua|Go|js|
		|成熟度|高|低|高|高|高|高|
		|使用成本|低|较低|高|较低|较低|较低|
		|IO模型|BIO|Netty(NIO)|epoll|epoll|AIO|AIO|
		|技术生态|Netflix|Spring Cloud|Nginx社区|OpenRestry|Go社区|Node.js社区|
		|适用场景|网关|网关|负载均衡|网关|网关|网关|
	)

#### php如何实现
- 水平分层强调的是物理上的分层，与MVC并不同
- 水平物理分层，涉及到网络操作、进程控制等，php不擅长，所以php基本不会做水平分层架构
- @todo 考虑用swoole支持
